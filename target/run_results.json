{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2023-11-04T15:13:09.999364Z", "invocation_id": "3cda9c4b-76b0-44f2-b277-7b716ceae299", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:12:53.118929Z", "completed_at": "2023-11-04T15:12:53.124911Z"}, {"name": "execute", "started_at": "2023-11-04T15:12:53.124911Z", "completed_at": "2023-11-04T15:12:54.706901Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6059765815734863, "adapter_response": {"_message": "SUCCESS", "rows_affected": 216, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.stg_databank_demographics\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"stg_databank_demographics\"\n      \n      \n    as (\n      with source as (\n\n    select * from \"postgresql\".\"covid\".\"databank_demographics\"\n\n),\n\nrenamed as (\n\n    select\n    \n        cast(iso3166_1 as VARCHAR) as iso3166_1,\n        cast(iso3166_2 as VARCHAR) as iso3166_2,\n        cast(fips as VARCHAR) as fips,\n        latitude,\n        longitude,\n        cast(state as VARCHAR) as state,\n        cast(county as VARCHAR) as county,\n        total_population,\n        total_male_population,\n        total_female_population,\n        country_region\n\n    from source\n\n)\n\nselect * from renamed\n    )", "query_id": "20231104_151256_21410_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.stg_databank_demographics", "compiled": true, "compiled_code": "with source as (\n\n    select * from \"postgresql\".\"covid\".\"databank_demographics\"\n\n),\n\nrenamed as (\n\n    select\n    \n        cast(iso3166_1 as VARCHAR) as iso3166_1,\n        cast(iso3166_2 as VARCHAR) as iso3166_2,\n        cast(fips as VARCHAR) as fips,\n        latitude,\n        longitude,\n        cast(state as VARCHAR) as state,\n        cast(county as VARCHAR) as county,\n        total_population,\n        total_male_population,\n        total_female_population,\n        country_region\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"stg_databank_demographics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:12:54.726095Z", "completed_at": "2023-11-04T15:12:54.729400Z"}, {"name": "execute", "started_at": "2023-11-04T15:12:54.729400Z", "completed_at": "2023-11-04T15:12:56.429772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7036762237548828, "adapter_response": {"_message": "SUCCESS", "rows_affected": 222804, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.stg_enigma_jhu\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"stg_enigma_jhu\"\n      \n      \n    as (\n      with source as (\n\n    select * from \"hive\".\"covid\".\"enigma_jhu\"\n\n),\n\nrenamed as (\n\n    select\n    \n        fips,\n        admin2 as county,\n        province_state,\n        country_region,\n        last_update,\n        latitude,\n        longitude,\n        confirmed,\n        combined_key\n\n    from source\n\n)\n\nselect * from renamed\n    )", "query_id": "20231104_151257_21411_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.stg_enigma_jhu", "compiled": true, "compiled_code": "with source as (\n\n    select * from \"hive\".\"covid\".\"enigma_jhu\"\n\n),\n\nrenamed as (\n\n    select\n    \n        fips,\n        admin2 as county,\n        province_state,\n        country_region,\n        last_update,\n        latitude,\n        longitude,\n        confirmed,\n        combined_key\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"stg_enigma_jhu\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:12:56.451233Z", "completed_at": "2023-11-04T15:12:56.451233Z"}, {"name": "execute", "started_at": "2023-11-04T15:12:56.451233Z", "completed_at": "2023-11-04T15:13:00.087783Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6618130207061768, "adapter_response": {"_message": "SUCCESS", "rows_affected": 167463, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.stg_owid_vaccinations\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"stg_owid_vaccinations\"\n      \n      \n    as (\n      with source as (\n\n    select * from \"postgresql\".\"covid\".\"owid_vaccinations\"\n\n),\n\nrenamed as (\n\n    select\n    \n        date,\n        country_region,\n        iso3166_1,\n        total_vaccinations,\n        people_vaccinated,\n        people_fully_vaccinated,\n        daily_vaccinations_raw,\n        daily_vaccinations,\n        total_vaccinations_per_hundred,\n        people_vaccinated_per_hundred,\n        daily_vaccinations_per_million,\n        vaccines,\n        last_observation_date,\n        source_name,\n        source_website,\n        cast(last_update_date as timestamp(3)) as last_update_date,\n        last_reported_flag\n\n    from source\n\n)\n\nselect * from renamed\n    )", "query_id": "20231104_151259_21413_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.stg_owid_vaccinations", "compiled": true, "compiled_code": "with source as (\n\n    select * from \"postgresql\".\"covid\".\"owid_vaccinations\"\n\n),\n\nrenamed as (\n\n    select\n    \n        date,\n        country_region,\n        iso3166_1,\n        total_vaccinations,\n        people_vaccinated,\n        people_fully_vaccinated,\n        daily_vaccinations_raw,\n        daily_vaccinations,\n        total_vaccinations_per_hundred,\n        people_vaccinated_per_hundred,\n        daily_vaccinations_per_million,\n        vaccines,\n        last_observation_date,\n        source_name,\n        source_website,\n        cast(last_update_date as timestamp(3)) as last_update_date,\n        last_reported_flag\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"stg_owid_vaccinations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:13:00.118400Z", "completed_at": "2023-11-04T15:13:00.121693Z"}, {"name": "execute", "started_at": "2023-11-04T15:13:00.121693Z", "completed_at": "2023-11-04T15:13:01.396264Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3067917823791504, "adapter_response": {"_message": "SUCCESS", "rows_affected": 26, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.stg_tpch_nations\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"stg_tpch_nations\"\n      \n      \n    as (\n      with source as (\n\n    select * from \"tpch\".\"tiny\".\"nation\"\n\n),\n\nrenamed as (\n\n    select\n    \n        nationkey as nation_key,\n        name as name,\n        regionkey as region_key,\n        comment as comment\n\n    from source\n    \n    union all (\n    \n    -- make sure to test for dupes!!!\n    select\n    \n      nationkey as nation_key,\n      null as name,\n      null as region_key,\n      null as comment\n      \n    from source\n    \n    limit 1\n  \n  )\n\n)\n\nselect * from renamed\n    )", "query_id": "20231104_151303_21415_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.stg_tpch_nations", "compiled": true, "compiled_code": "with source as (\n\n    select * from \"tpch\".\"tiny\".\"nation\"\n\n),\n\nrenamed as (\n\n    select\n    \n        nationkey as nation_key,\n        name as name,\n        regionkey as region_key,\n        comment as comment\n\n    from source\n    \n    union all (\n    \n    -- make sure to test for dupes!!!\n    select\n    \n      nationkey as nation_key,\n      null as name,\n      null as region_key,\n      null as comment\n      \n    from source\n    \n    limit 1\n  \n  )\n\n)\n\nselect * from renamed", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"stg_tpch_nations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:13:01.435631Z", "completed_at": "2023-11-04T15:13:01.437737Z"}, {"name": "execute", "started_at": "2023-11-04T15:13:01.437737Z", "completed_at": "2023-11-04T15:13:02.816284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3982138633728027, "adapter_response": {"_message": "SUCCESS", "rows_affected": 5, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.stg_tpch_regions\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"stg_tpch_regions\"\n      \n      \n    as (\n      with source as (\n\n    select * from \"tpch\".\"tiny\".\"region\"\n\n),\n\nrenamed as (\n\n    select\n    \n        regionkey as region_key,\n        name as name,\n        comment as comment\n\n    from source\n\n)\n\nselect * from renamed\n    )", "query_id": "20231104_151305_21417_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.stg_tpch_regions", "compiled": true, "compiled_code": "with source as (\n\n    select * from \"tpch\".\"tiny\".\"region\"\n\n),\n\nrenamed as (\n\n    select\n    \n        regionkey as region_key,\n        name as name,\n        comment as comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"stg_tpch_regions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:13:02.846854Z", "completed_at": "2023-11-04T15:13:02.853838Z"}, {"name": "execute", "started_at": "2023-11-04T15:13:02.853838Z", "completed_at": "2023-11-04T15:13:04.068207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2363646030426025, "adapter_response": {"_message": "SUCCESS", "rows_affected": 3713, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.int_aws_cases\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"int_aws_cases\"\n      \n      \n    as (\n      \n\nwith enigma as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_enigma_jhu\"\n\n),\n\n\nfinal as (\n\nWITH\n    cases AS (\n        SELECT\n            fips,\n            county,\n            province_state,\n            replace(country_region, 'US', 'UNITED STATES') as country_region,\n            confirmed,\n            first_value(last_update) OVER (\n              PARTITION BY fips ORDER BY last_update DESC) AS most_recent,\n            last_update\n        FROM\n            enigma\n    )\nSELECT\n    fips,\n    county,\n    province_state,\n    UPPER(country_region) as country,\n    confirmed,\n    last_update\nFROM\n    cases\nWHERE\n    last_update = most_recent\nGROUP BY\n    fips,\n    county,\n    province_state,\n    country_region,\n    confirmed,\n    last_update\n)\n\nselect * from final\n    )", "query_id": "20231104_151305_21418_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.int_aws_cases", "compiled": true, "compiled_code": "\n\nwith enigma as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_enigma_jhu\"\n\n),\n\n\nfinal as (\n\nWITH\n    cases AS (\n        SELECT\n            fips,\n            county,\n            province_state,\n            replace(country_region, 'US', 'UNITED STATES') as country_region,\n            confirmed,\n            first_value(last_update) OVER (\n              PARTITION BY fips ORDER BY last_update DESC) AS most_recent,\n            last_update\n        FROM\n            enigma\n    )\nSELECT\n    fips,\n    county,\n    province_state,\n    UPPER(country_region) as country,\n    confirmed,\n    last_update\nFROM\n    cases\nWHERE\n    last_update = most_recent\nGROUP BY\n    fips,\n    county,\n    province_state,\n    country_region,\n    confirmed,\n    last_update\n)\n\nselect * from final", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"int_aws_cases\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:13:04.076338Z", "completed_at": "2023-11-04T15:13:04.076338Z"}, {"name": "execute", "started_at": "2023-11-04T15:13:04.083846Z", "completed_at": "2023-11-04T15:13:05.860129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.793095350265503, "adapter_response": {"_message": "SUCCESS", "rows_affected": 186, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.int_snow_population\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"int_snow_population\"\n      \n      \n    as (\n      \n\nwith demographics as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_databank_demographics\"\n\n),\n\nvaccines as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_owid_vaccinations\"\n\n),\n\nfinal as (\n    \n    select\n        demographics.country_region as country_region,\n        demographics.total_population as total_population,\n        max(vaccines.people_vaccinated) as vaccinated_population\n    from\n        demographics\n    inner join vaccines\n            on demographics.country_region = vaccines.country_region\n    group by\n        demographics.country_region,\n        demographics.total_population\n)\nselect\n    UPPER(country_region) as country_region,\n    total_population,\n    vaccinated_population\nfrom\n    final\n    )", "query_id": "20231104_151307_21420_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.int_snow_population", "compiled": true, "compiled_code": "\n\nwith demographics as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_databank_demographics\"\n\n),\n\nvaccines as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_owid_vaccinations\"\n\n),\n\nfinal as (\n    \n    select\n        demographics.country_region as country_region,\n        demographics.total_population as total_population,\n        max(vaccines.people_vaccinated) as vaccinated_population\n    from\n        demographics\n    inner join vaccines\n            on demographics.country_region = vaccines.country_region\n    group by\n        demographics.country_region,\n        demographics.total_population\n)\nselect\n    UPPER(country_region) as country_region,\n    total_population,\n    vaccinated_population\nfrom\n    final", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"int_snow_population\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:13:05.870480Z", "completed_at": "2023-11-04T15:13:05.870480Z"}, {"name": "execute", "started_at": "2023-11-04T15:13:05.870480Z", "completed_at": "2023-11-04T15:13:07.440279Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5808331966400146, "adapter_response": {"_message": "SUCCESS", "rows_affected": 25, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.int_tpch_location\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"int_tpch_location\"\n      \n      \n    as (\n      \n\nwith nation as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_tpch_nations\"\n\n),\nregion as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_tpch_regions\"\n\n),\n\nfinal as (\n    \n    select\n        nation.nation_key,\n        nation.name as nation,\n        nation.region_key,\n        region.name as region\n    from\n        nation\n    inner join region\n            on nation.region_key = region.region_key\n)\nselect\n    *\nfrom\n    final\norder by\n    nation_key\n    )", "query_id": "20231104_151309_21422_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.int_tpch_location", "compiled": true, "compiled_code": "\n\nwith nation as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_tpch_nations\"\n\n),\nregion as (\n    \n    select * from \"hive\".\"victorc_dbt_dev\".\"stg_tpch_regions\"\n\n),\n\nfinal as (\n    \n    select\n        nation.nation_key,\n        nation.name as nation,\n        nation.region_key,\n        region.name as region\n    from\n        nation\n    inner join region\n            on nation.region_key = region.region_key\n)\nselect\n    *\nfrom\n    final\norder by\n    nation_key", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"int_tpch_location\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:13:07.466638Z", "completed_at": "2023-11-04T15:13:07.477821Z"}, {"name": "execute", "started_at": "2023-11-04T15:13:07.480963Z", "completed_at": "2023-11-04T15:13:08.458866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0082945823669434, "adapter_response": {"_message": "SUCCESS", "rows_affected": 22, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.agg_nation\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"agg_nation\"\n      \n      \n    as (\n      \n\nwith cases as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_aws_cases\"\n),\n\npopulations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_snow_population\"\n),\n\nlocations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_tpch_location\"\n),\n\nfinal as (\n    \n    select\n        cases.country,\n        locations.nation_key,\n        cases.confirmed,\n        locations.nation,\n        populations.total_population,\n        populations.vaccinated_population,\n        first_value(cases.last_update) OVER (\n            PARTITION BY cases.fips ORDER BY cases.last_update DESC) AS most_recent,\n        cases.last_update\n    from\n        cases\n    inner join locations\n            on cases.country = locations.nation\n    inner join populations\n            on locations.nation = populations.country_region\n)\n\nselect\n    nation,\n    SUM(CAST(confirmed as int)) AS total_confirmed_cases,\n    SUM(total_population) as total_region_population,\n    SUM(vaccinated_population) as vaccinated_population\nfrom\n    final\nWHERE\n    last_update = most_recent\nGROUP BY\n    nation\nORDER BY\n    total_confirmed_cases DESC\n    )", "query_id": "20231104_151310_21423_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.agg_nation", "compiled": true, "compiled_code": "\n\nwith cases as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_aws_cases\"\n),\n\npopulations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_snow_population\"\n),\n\nlocations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_tpch_location\"\n),\n\nfinal as (\n    \n    select\n        cases.country,\n        locations.nation_key,\n        cases.confirmed,\n        locations.nation,\n        populations.total_population,\n        populations.vaccinated_population,\n        first_value(cases.last_update) OVER (\n            PARTITION BY cases.fips ORDER BY cases.last_update DESC) AS most_recent,\n        cases.last_update\n    from\n        cases\n    inner join locations\n            on cases.country = locations.nation\n    inner join populations\n            on locations.nation = populations.country_region\n)\n\nselect\n    nation,\n    SUM(CAST(confirmed as int)) AS total_confirmed_cases,\n    SUM(total_population) as total_region_population,\n    SUM(vaccinated_population) as vaccinated_population\nfrom\n    final\nWHERE\n    last_update = most_recent\nGROUP BY\n    nation\nORDER BY\n    total_confirmed_cases DESC", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"agg_nation\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-04T15:13:08.484761Z", "completed_at": "2023-11-04T15:13:08.495433Z"}, {"name": "execute", "started_at": "2023-11-04T15:13:08.498399Z", "completed_at": "2023-11-04T15:13:09.983228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5126368999481201, "adapter_response": {"_message": "SUCCESS", "rows_affected": 5, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.0\", \"profile_name\": \"sandbox-starburst\", \"target_name\": \"dev\", \"node_id\": \"model.dbt_starburst_covid_demo.agg_region\"} */\n\n  \n    \n\n    create table \"hive\".\"victorc_dbt_dev\".\"agg_region\"\n      \n      \n    as (\n      \n\n\nwith cases as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_aws_cases\"\n),\n\npopulations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_snow_population\"\n),\n\nlocations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_tpch_location\"\n),\n\nfinal as (\n    \n    select\n        cases.country,\n        locations.nation_key,\n        cases.confirmed,\n        locations.region,\n        populations.total_population,\n        populations.vaccinated_population,\n        first_value(cases.last_update) OVER (\n            PARTITION BY cases.fips ORDER BY cases.last_update DESC) AS most_recent,\n        cases.last_update\n    from\n        cases\n    inner join locations\n            on cases.country = locations.nation\n    inner join populations\n            on locations.nation = populations.country_region\n)\n\nselect\n    region,\n    SUM(CAST(confirmed as int)) AS total_confirmed_cases,\n    SUM(total_population) as total_region_population,\n    SUM(vaccinated_population) as vaccinated_population\nfrom\n    final\nWHERE\n    last_update = most_recent\nGROUP BY\n    region\nORDER BY\n    total_confirmed_cases DESC\n    )", "query_id": "20231104_151311_21424_mgmfy"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_starburst_covid_demo.agg_region", "compiled": true, "compiled_code": "\n\n\nwith cases as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_aws_cases\"\n),\n\npopulations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_snow_population\"\n),\n\nlocations as (\n    select * from \"hive\".\"victorc_dbt_dev\".\"int_tpch_location\"\n),\n\nfinal as (\n    \n    select\n        cases.country,\n        locations.nation_key,\n        cases.confirmed,\n        locations.region,\n        populations.total_population,\n        populations.vaccinated_population,\n        first_value(cases.last_update) OVER (\n            PARTITION BY cases.fips ORDER BY cases.last_update DESC) AS most_recent,\n        cases.last_update\n    from\n        cases\n    inner join locations\n            on cases.country = locations.nation\n    inner join populations\n            on locations.nation = populations.country_region\n)\n\nselect\n    region,\n    SUM(CAST(confirmed as int)) AS total_confirmed_cases,\n    SUM(total_population) as total_region_population,\n    SUM(vaccinated_population) as vaccinated_population\nfrom\n    final\nWHERE\n    last_update = most_recent\nGROUP BY\n    region\nORDER BY\n    total_confirmed_cases DESC", "relation_name": "\"hive\".\"victorc_dbt_dev\".\"agg_region\""}], "elapsed_time": 18.594717264175415, "args": {"project_dir": "C:\\Users\\sebas\\OneDrive - Komeet Technologies\\Komeet\\DBT\\workspaces\\starburst-dbt\\dbt-galaxy-covid-demo", "use_colors_file": true, "partial_parse": true, "use_colors": true, "show_resource_report": false, "select": [], "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "log_level_file": "debug", "quiet": false, "version_check": true, "favor_state": false, "macro_debugging": false, "log_format": "default", "print": true, "populate_cache": true, "write_json": true, "profiles_dir": "C:\\Users\\sebas\\.dbt", "static_parser": true, "enable_legacy_logger": false, "cache_selected_only": false, "partial_parse_file_diff": true, "vars": {}, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "exclude": [], "invocation_command": "dbt run", "log_path": "C:\\Users\\sebas\\OneDrive - Komeet Technologies\\Komeet\\DBT\\workspaces\\starburst-dbt\\dbt-galaxy-covid-demo\\logs", "defer": false, "strict_mode": false, "log_file_max_bytes": 10485760, "introspect": true, "log_format_file": "debug", "which": "run", "printer_width": 80}}